var Te=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function pt(a){return a&&a.__esModule&&Object.prototype.hasOwnProperty.call(a,"default")?a.default:a}var le={exports:{}};le.exports;var ut;function In(){return ut||(ut=1,function(a,l){var f=200,u="__lodash_hash_undefined__",g=1,S=2,_=9007199254740991,I="[object Arguments]",O="[object Array]",N="[object AsyncFunction]",pe="[object Boolean]",fe="[object Date]",he="[object Error]",W="[object Function]",q="[object GeneratorFunction]",ee="[object Map]",j="[object Number]",Ce="[object Null]",E="[object Object]",re="[object Promise]",ie="[object Proxy]",ge="[object RegExp]",te="[object Set]",r="[object String]",s="[object Symbol]",i="[object Undefined]",c="[object WeakMap]",p="[object ArrayBuffer]",d="[object DataView]",y="[object Float32Array]",B="[object Float64Array]",z="[object Int8Array]",R="[object Int16Array]",H="[object Int32Array]",$="[object Uint8Array]",Me="[object Uint8ClampedArray]",ht="[object Uint16Array]",gt="[object Uint32Array]",dt=/[\\^$.*+?()[\]{}|]/g,_t=/^\[object .+?Constructor\]$/,yt=/^(?:0|[1-9]\d*)$/,b={};b[y]=b[B]=b[z]=b[R]=b[H]=b[$]=b[Me]=b[ht]=b[gt]=!0,b[I]=b[O]=b[p]=b[pe]=b[d]=b[fe]=b[he]=b[W]=b[ee]=b[j]=b[E]=b[ge]=b[te]=b[r]=b[c]=!1;var $e=typeof Te=="object"&&Te&&Te.Object===Object&&Te,bt=typeof self=="object"&&self&&self.Object===Object&&self,F=$e||bt||Function("return this")(),Fe=l&&!l.nodeType&&l,De=Fe&&!0&&a&&!a.nodeType&&a,Ge=De&&De.exports===Fe,Oe=Ge&&$e.process,Ne=function(){try{return Oe&&Oe.binding&&Oe.binding("util")}catch{}}(),qe=Ne&&Ne.isTypedArray;function vt(e,t){for(var n=-1,o=e==null?0:e.length,v=0,h=[];++n<o;){var w=e[n];t(w,n,e)&&(h[v++]=w)}return h}function mt(e,t){for(var n=-1,o=t.length,v=e.length;++n<o;)e[v+n]=t[n];return e}function wt(e,t){for(var n=-1,o=e==null?0:e.length;++n<o;)if(t(e[n],n,e))return!0;return!1}function St(e,t){for(var n=-1,o=Array(e);++n<e;)o[n]=t(n);return o}function Tt(e){return function(t){return e(t)}}function Ct(e,t){return e.has(t)}function Mt(e,t){return e==null?void 0:e[t]}function Ot(e){var t=-1,n=Array(e.size);return e.forEach(function(o,v){n[++t]=[v,o]}),n}function At(e,t){return function(n){return e(t(n))}}function Pt(e){var t=-1,n=Array(e.size);return e.forEach(function(o){n[++t]=o}),n}var xt=Array.prototype,It=Function.prototype,de=Object.prototype,Ae=F["__core-js_shared__"],ze=It.toString,k=de.hasOwnProperty,Ue=function(){var e=/[^.]+$/.exec(Ae&&Ae.keys&&Ae.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}(),Ke=de.toString,jt=RegExp("^"+ze.call(k).replace(dt,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Je=Ge?F.Buffer:void 0,_e=F.Symbol,We=F.Uint8Array,Xe=de.propertyIsEnumerable,Et=xt.splice,X=_e?_e.toStringTag:void 0,Ye=Object.getOwnPropertySymbols,Rt=Je?Je.isBuffer:void 0,Lt=At(Object.keys,Object),Pe=ne(F,"DataView"),se=ne(F,"Map"),xe=ne(F,"Promise"),Ie=ne(F,"Set"),je=ne(F,"WeakMap"),ae=ne(Object,"create"),kt=Q(Pe),Bt=Q(se),Ht=Q(xe),$t=Q(Ie),Ft=Q(je),Ze=_e?_e.prototype:void 0,Ee=Ze?Ze.valueOf:void 0;function Y(e){var t=-1,n=e==null?0:e.length;for(this.clear();++t<n;){var o=e[t];this.set(o[0],o[1])}}function Dt(){this.__data__=ae?ae(null):{},this.size=0}function Gt(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}function Nt(e){var t=this.__data__;if(ae){var n=t[e];return n===u?void 0:n}return k.call(t,e)?t[e]:void 0}function qt(e){var t=this.__data__;return ae?t[e]!==void 0:k.call(t,e)}function zt(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=ae&&t===void 0?u:t,this}Y.prototype.clear=Dt,Y.prototype.delete=Gt,Y.prototype.get=Nt,Y.prototype.has=qt,Y.prototype.set=zt;function D(e){var t=-1,n=e==null?0:e.length;for(this.clear();++t<n;){var o=e[t];this.set(o[0],o[1])}}function Ut(){this.__data__=[],this.size=0}function Kt(e){var t=this.__data__,n=be(t,e);if(n<0)return!1;var o=t.length-1;return n==o?t.pop():Et.call(t,n,1),--this.size,!0}function Jt(e){var t=this.__data__,n=be(t,e);return n<0?void 0:t[n][1]}function Wt(e){return be(this.__data__,e)>-1}function Xt(e,t){var n=this.__data__,o=be(n,e);return o<0?(++this.size,n.push([e,t])):n[o][1]=t,this}D.prototype.clear=Ut,D.prototype.delete=Kt,D.prototype.get=Jt,D.prototype.has=Wt,D.prototype.set=Xt;function Z(e){var t=-1,n=e==null?0:e.length;for(this.clear();++t<n;){var o=e[t];this.set(o[0],o[1])}}function Yt(){this.size=0,this.__data__={hash:new Y,map:new(se||D),string:new Y}}function Zt(e){var t=ve(this,e).delete(e);return this.size-=t?1:0,t}function Qt(e){return ve(this,e).get(e)}function Vt(e){return ve(this,e).has(e)}function en(e,t){var n=ve(this,e),o=n.size;return n.set(e,t),this.size+=n.size==o?0:1,this}Z.prototype.clear=Yt,Z.prototype.delete=Zt,Z.prototype.get=Qt,Z.prototype.has=Vt,Z.prototype.set=en;function ye(e){var t=-1,n=e==null?0:e.length;for(this.__data__=new Z;++t<n;)this.add(e[t])}function tn(e){return this.__data__.set(e,u),this}function nn(e){return this.__data__.has(e)}ye.prototype.add=ye.prototype.push=tn,ye.prototype.has=nn;function U(e){var t=this.__data__=new D(e);this.size=t.size}function rn(){this.__data__=new D,this.size=0}function sn(e){var t=this.__data__,n=t.delete(e);return this.size=t.size,n}function an(e){return this.__data__.get(e)}function on(e){return this.__data__.has(e)}function un(e,t){var n=this.__data__;if(n instanceof D){var o=n.__data__;if(!se||o.length<f-1)return o.push([e,t]),this.size=++n.size,this;n=this.__data__=new Z(o)}return n.set(e,t),this.size=n.size,this}U.prototype.clear=rn,U.prototype.delete=sn,U.prototype.get=an,U.prototype.has=on,U.prototype.set=un;function ln(e,t){var n=me(e),o=!n&&Cn(e),v=!n&&!o&&Re(e),h=!n&&!o&&!v&&at(e),w=n||o||v||h,T=w?St(e.length,String):[],C=T.length;for(var m in e)k.call(e,m)&&!(w&&(m=="length"||v&&(m=="offset"||m=="parent")||h&&(m=="buffer"||m=="byteLength"||m=="byteOffset")||vn(m,C)))&&T.push(m);return T}function be(e,t){for(var n=e.length;n--;)if(nt(e[n][0],t))return n;return-1}function cn(e,t,n){var o=t(e);return me(e)?o:mt(o,n(e))}function oe(e){return e==null?e===void 0?i:Ce:X&&X in Object(e)?yn(e):Tn(e)}function Qe(e){return ue(e)&&oe(e)==I}function Ve(e,t,n,o,v){return e===t?!0:e==null||t==null||!ue(e)&&!ue(t)?e!==e&&t!==t:pn(e,t,n,o,Ve,v)}function pn(e,t,n,o,v,h){var w=me(e),T=me(t),C=w?O:K(e),m=T?O:K(t);C=C==I?E:C,m=m==I?E:m;var A=C==E,L=m==E,M=C==m;if(M&&Re(e)){if(!Re(t))return!1;w=!0,A=!1}if(M&&!A)return h||(h=new U),w||at(e)?et(e,t,n,o,v,h):dn(e,t,C,n,o,v,h);if(!(n&g)){var P=A&&k.call(e,"__wrapped__"),x=L&&k.call(t,"__wrapped__");if(P||x){var J=P?e.value():e,G=x?t.value():t;return h||(h=new U),v(J,G,n,o,h)}}return M?(h||(h=new U),_n(e,t,n,o,v,h)):!1}function fn(e){if(!st(e)||wn(e))return!1;var t=rt(e)?jt:_t;return t.test(Q(e))}function hn(e){return ue(e)&&it(e.length)&&!!b[oe(e)]}function gn(e){if(!Sn(e))return Lt(e);var t=[];for(var n in Object(e))k.call(e,n)&&n!="constructor"&&t.push(n);return t}function et(e,t,n,o,v,h){var w=n&g,T=e.length,C=t.length;if(T!=C&&!(w&&C>T))return!1;var m=h.get(e);if(m&&h.get(t))return m==t;var A=-1,L=!0,M=n&S?new ye:void 0;for(h.set(e,t),h.set(t,e);++A<T;){var P=e[A],x=t[A];if(o)var J=w?o(x,P,A,t,e,h):o(P,x,A,e,t,h);if(J!==void 0){if(J)continue;L=!1;break}if(M){if(!wt(t,function(G,V){if(!Ct(M,V)&&(P===G||v(P,G,n,o,h)))return M.push(V)})){L=!1;break}}else if(!(P===x||v(P,x,n,o,h))){L=!1;break}}return h.delete(e),h.delete(t),L}function dn(e,t,n,o,v,h,w){switch(n){case d:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case p:return!(e.byteLength!=t.byteLength||!h(new We(e),new We(t)));case pe:case fe:case j:return nt(+e,+t);case he:return e.name==t.name&&e.message==t.message;case ge:case r:return e==t+"";case ee:var T=Ot;case te:var C=o&g;if(T||(T=Pt),e.size!=t.size&&!C)return!1;var m=w.get(e);if(m)return m==t;o|=S,w.set(e,t);var A=et(T(e),T(t),o,v,h,w);return w.delete(e),A;case s:if(Ee)return Ee.call(e)==Ee.call(t)}return!1}function _n(e,t,n,o,v,h){var w=n&g,T=tt(e),C=T.length,m=tt(t),A=m.length;if(C!=A&&!w)return!1;for(var L=C;L--;){var M=T[L];if(!(w?M in t:k.call(t,M)))return!1}var P=h.get(e);if(P&&h.get(t))return P==t;var x=!0;h.set(e,t),h.set(t,e);for(var J=w;++L<C;){M=T[L];var G=e[M],V=t[M];if(o)var ot=w?o(V,G,M,t,e,h):o(G,V,M,e,t,h);if(!(ot===void 0?G===V||v(G,V,n,o,h):ot)){x=!1;break}J||(J=M=="constructor")}if(x&&!J){var we=e.constructor,Se=t.constructor;we!=Se&&"constructor"in e&&"constructor"in t&&!(typeof we=="function"&&we instanceof we&&typeof Se=="function"&&Se instanceof Se)&&(x=!1)}return h.delete(e),h.delete(t),x}function tt(e){return cn(e,An,bn)}function ve(e,t){var n=e.__data__;return mn(t)?n[typeof t=="string"?"string":"hash"]:n.map}function ne(e,t){var n=Mt(e,t);return fn(n)?n:void 0}function yn(e){var t=k.call(e,X),n=e[X];try{e[X]=void 0;var o=!0}catch{}var v=Ke.call(e);return o&&(t?e[X]=n:delete e[X]),v}var bn=Ye?function(e){return e==null?[]:(e=Object(e),vt(Ye(e),function(t){return Xe.call(e,t)}))}:Pn,K=oe;(Pe&&K(new Pe(new ArrayBuffer(1)))!=d||se&&K(new se)!=ee||xe&&K(xe.resolve())!=re||Ie&&K(new Ie)!=te||je&&K(new je)!=c)&&(K=function(e){var t=oe(e),n=t==E?e.constructor:void 0,o=n?Q(n):"";if(o)switch(o){case kt:return d;case Bt:return ee;case Ht:return re;case $t:return te;case Ft:return c}return t});function vn(e,t){return t=t??_,!!t&&(typeof e=="number"||yt.test(e))&&e>-1&&e%1==0&&e<t}function mn(e){var t=typeof e;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?e!=="__proto__":e===null}function wn(e){return!!Ue&&Ue in e}function Sn(e){var t=e&&e.constructor,n=typeof t=="function"&&t.prototype||de;return e===n}function Tn(e){return Ke.call(e)}function Q(e){if(e!=null){try{return ze.call(e)}catch{}try{return e+""}catch{}}return""}function nt(e,t){return e===t||e!==e&&t!==t}var Cn=Qe(function(){return arguments}())?Qe:function(e){return ue(e)&&k.call(e,"callee")&&!Xe.call(e,"callee")},me=Array.isArray;function Mn(e){return e!=null&&it(e.length)&&!rt(e)}var Re=Rt||xn;function On(e,t){return Ve(e,t)}function rt(e){if(!st(e))return!1;var t=oe(e);return t==W||t==q||t==N||t==ie}function it(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=_}function st(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")}function ue(e){return e!=null&&typeof e=="object"}var at=qe?Tt(qe):hn;function An(e){return Mn(e)?ln(e):gn(e)}function Pn(){return[]}function xn(){return!1}a.exports=On}(le,le.exports)),le.exports}var jn=In(),En=pt(jn);function ke(a,l,f){const u={id:[l,f,"circle"].join("_"),source:l,type:"circle",paint:{"circle-color":a,"circle-radius":2},filter:["==","$type","Point"]};return f&&(u["source-layer"]=f),u}function Be(a,l,f,u){const g={id:[f,u,"polygon"].join("_"),source:f,type:"fill",paint:{"fill-color":a,"fill-antialias":!0,"fill-outline-color":a},filter:["==","$type","Polygon"]};return u&&(g["source-layer"]=u),g}function He(a,l,f){const u={id:[l,f,"line"].join("_"),source:l,layout:{"line-join":"round","line-cap":"round"},type:"line",paint:{"line-color":a},filter:["==","$type","LineString"]};return f&&(u["source-layer"]=f),u}function Rn(a,l){const f=[],u=[],g=[];function S(_){return{circle:l(_,.8),line:l(_,.6),polygon:l(_,.3),polygonOutline:l(_,.6),default:l(_,1)}}return Object.keys(a).forEach(_=>{const I=a[_];if(!I||I.length===0){const O=S(_);u.push(ke(O.circle,_)),g.push(He(O.line,_)),f.push(Be(O.polygon,O.polygonOutline,_))}else I.forEach(O=>{const N=S(O);u.push(ke(N.circle,_,O)),g.push(He(N.line,_,O)),f.push(Be(N.polygon,N.polygonOutline,_,O))})}),f.concat(g).concat(u)}function Ln(a,l,f){f=Object.assign({backgroundColor:"#fff"},f);const u={id:"background",type:"background",paint:{"background-color":f.backgroundColor}},g={};return Object.keys(a.sources).forEach(S=>{const _=a.sources[S];(_.type==="vector"||_.type==="geojson")&&(g[S]=_)}),Object.assign(a,{layers:[u].concat(l),sources:g})}var lt={polygonLayer:Be,lineLayer:He,circleLayer:ke,generateInspectStyle:Ln,generateColoredLayers:Rn};class kn{constructor(l){l=Object.assign({show:!0,onToggle(){}},l),this._btn=this.createButton(),this._btn.onclick=l.onToggle,this.elem=this.createContainer(this._btn,l.show)}createButton(){const l=document.createElement("button");return l.className="maplibregl-ctrl-icon maplibregl-ctrl-inspect",l.type="button",l.title="Toggle Inspect",l.setAttribute("aria-label","Toggle Inspect"),l}createContainer(l,f){const u=document.createElement("div");return u.className="maplibregl-ctrl maplibregl-ctrl-group",u.appendChild(l),f||(u.style.display="none"),u}setInspectIcon(){this._btn.className="maplibregl-ctrl-icon maplibregl-ctrl-inspect"}setMapIcon(){this._btn.className="maplibregl-ctrl-icon maplibregl-ctrl-map"}}function Bn(a){return typeof a>"u"||a===null?a:a instanceof Date?a.toLocaleString():typeof a=="object"||typeof a=="number"||typeof a=="string"?a.toString():a}function Le(a,l){return`<div class="maplibregl-inspect_property"><div class="maplibregl-inspect_property-name">${a}</div><div class="maplibregl-inspect_property-value">${Bn(l)}</div></div>`}function Hn(a){return`<div class="maplibregl-inspect_layer">${a}</div>`}function $n(a){const l=Hn(a.layer["source-layer"]||a.layer.source),f=Le("$id",a.id),u=Le("$type",a.geometry.type),g=Object.keys(a.properties).map(S=>Le(S,a.properties[S]));return[l,f,u].concat(g).join("")}function Fn(a){return a.map(l=>`<div class="maplibregl-inspect_feature">${$n(l)}</div>`).join("")}function Dn(a){return`<div class="maplibregl-inspect_popup">${Fn(a)}</div>`}var ce={exports:{}},Gn=ce.exports,ct;function Nn(){return ct||(ct=1,function(a,l){(function(f,u){{var g=u();a.exports&&(l=a.exports=g),l.randomColor=g}})(Gn,function(){var f=null,u={};Ce();var g=[],S=function(r){if(r=r||{},r.seed!==void 0&&r.seed!==null&&r.seed===parseInt(r.seed,10))f=r.seed;else if(typeof r.seed=="string")f=ge(r.seed);else{if(r.seed!==void 0&&r.seed!==null)throw new TypeError("The seed value must be an integer or string");f=null}var s,i,c;if(r.count!==null&&r.count!==void 0){for(var p=r.count,d=[],y=0;y<r.count;y++)g.push(!1);for(r.count=null;p>d.length;){var B=S(r);f!==null&&(r.seed=f),d.push(B)}return r.count=p,d}return s=_(r),i=I(s,r),c=O(s,i,r),N([s,i,c],r)};function _(r){if(g.length>0){var s=te(r.hue),i=q(s),c=(s[1]-s[0])/g.length,p=parseInt((i-s[0])/c);g[p]===!0?p=(p+2)%g.length:g[p]=!0;var d=(s[0]+p*c)%359,y=(s[0]+(p+1)*c)%359;return s=[d,y],i=q(s),i<0&&(i=360+i),i}else{var s=fe(r.hue);return i=q(s),i<0&&(i=360+i),i}}function I(r,s){if(s.hue==="monochrome")return 0;if(s.luminosity==="random")return q([0,100]);var i=he(r),c=i[0],p=i[1];switch(s.luminosity){case"bright":c=55;break;case"dark":c=p-10;break;case"light":p=55;break}return q([c,p])}function O(r,s,i){var c=pe(r,s),p=100;switch(i.luminosity){case"dark":p=c+20;break;case"light":c=(p+c)/2;break;case"random":c=0,p=100;break}return q([c,p])}function N(r,s){switch(s.format){case"hsvArray":return r;case"hslArray":return ie(r);case"hsl":var i=ie(r);return"hsl("+i[0]+", "+i[1]+"%, "+i[2]+"%)";case"hsla":var c=ie(r),y=s.alpha||Math.random();return"hsla("+c[0]+", "+c[1]+"%, "+c[2]+"%, "+y+")";case"rgbArray":return E(r);case"rgb":var p=E(r);return"rgb("+p.join(", ")+")";case"rgba":var d=E(r),y=s.alpha||Math.random();return"rgba("+d.join(", ")+", "+y+")";default:return ee(r)}}function pe(r,s){for(var i=W(r).lowerBounds,c=0;c<i.length-1;c++){var p=i[c][0],d=i[c][1],y=i[c+1][0],B=i[c+1][1];if(s>=p&&s<=y){var z=(B-d)/(y-p),R=d-z*p;return z*s+R}}return 0}function fe(r){if(typeof parseInt(r)=="number"){var s=parseInt(r);if(s<360&&s>0)return[s,s]}if(typeof r=="string"){if(u[r]){var i=u[r];if(i.hueRange)return i.hueRange}else if(r.match(/^#?([0-9A-F]{3}|[0-9A-F]{6})$/i)){var c=re(r)[0];return[c,c]}}return[0,360]}function he(r){return W(r).saturationRange}function W(r){r>=334&&r<=360&&(r-=360);for(var s in u){var i=u[s];if(i.hueRange&&r>=i.hueRange[0]&&r<=i.hueRange[1])return u[s]}return"Color not found"}function q(r){if(f===null){var s=.618033988749895,i=Math.random();return i+=s,i%=1,Math.floor(r[0]+i*(r[1]+1-r[0]))}else{var c=r[1]||1,p=r[0]||0;f=(f*9301+49297)%233280;var d=f/233280;return Math.floor(p+d*(c-p))}}function ee(r){var s=E(r);function i(p){var d=p.toString(16);return d.length==1?"0"+d:d}var c="#"+i(s[0])+i(s[1])+i(s[2]);return c}function j(r,s,i){var c=i[0][0],p=i[i.length-1][0],d=i[i.length-1][1],y=i[0][1];u[r]={hueRange:s,lowerBounds:i,saturationRange:[c,p],brightnessRange:[d,y]}}function Ce(){j("monochrome",null,[[0,0],[100,0]]),j("red",[-26,18],[[20,100],[30,92],[40,89],[50,85],[60,78],[70,70],[80,60],[90,55],[100,50]]),j("orange",[18,46],[[20,100],[30,93],[40,88],[50,86],[60,85],[70,70],[100,70]]),j("yellow",[46,62],[[25,100],[40,94],[50,89],[60,86],[70,84],[80,82],[90,80],[100,75]]),j("green",[62,178],[[30,100],[40,90],[50,85],[60,81],[70,74],[80,64],[90,50],[100,40]]),j("blue",[178,257],[[20,100],[30,86],[40,80],[50,74],[60,60],[70,52],[80,44],[90,39],[100,35]]),j("purple",[257,282],[[20,100],[30,87],[40,79],[50,70],[60,65],[70,59],[80,52],[90,45],[100,42]]),j("pink",[282,334],[[20,100],[30,90],[40,86],[60,84],[80,80],[90,75],[100,73]])}function E(r){var s=r[0];s===0&&(s=1),s===360&&(s=359),s=s/360;var i=r[1]/100,c=r[2]/100,p=Math.floor(s*6),d=s*6-p,y=c*(1-i),B=c*(1-d*i),z=c*(1-(1-d)*i),R=256,H=256,$=256;switch(p){case 0:R=c,H=z,$=y;break;case 1:R=B,H=c,$=y;break;case 2:R=y,H=c,$=z;break;case 3:R=y,H=B,$=c;break;case 4:R=z,H=y,$=c;break;case 5:R=c,H=y,$=B;break}var Me=[Math.floor(R*255),Math.floor(H*255),Math.floor($*255)];return Me}function re(r){r=r.replace(/^#/,""),r=r.length===3?r.replace(/(.)/g,"$1$1"):r;var s=parseInt(r.substr(0,2),16)/255,i=parseInt(r.substr(2,2),16)/255,c=parseInt(r.substr(4,2),16)/255,p=Math.max(s,i,c),d=p-Math.min(s,i,c),y=p?d/p:0;switch(p){case s:return[60*((i-c)/d%6)||0,y,p];case i:return[60*((c-s)/d+2)||0,y,p];case c:return[60*((s-i)/d+4)||0,y,p]}}function ie(r){var s=r[0],i=r[1]/100,c=r[2]/100,p=(2-i)*c;return[s,Math.round(i*c/(p<1?p:2-p)*1e4)/100,p/2*100]}function ge(r){for(var s=0,i=0;i!==r.length&&!(s>=Number.MAX_SAFE_INTEGER);i++)s+=r.charCodeAt(i);return s}function te(r){if(isNaN(r)){if(typeof r=="string"){if(u[r]){var i=u[r];if(i.hueRange)return i.hueRange}else if(r.match(/^#?([0-9A-F]{3}|[0-9A-F]{6})$/i)){var c=re(r)[0];return W(c).hueRange}}}else{var s=parseInt(r);if(s<360&&s>0)return W(r).hueRange}return[0,360]}return S})}(ce,ce.exports)),ce.exports}var qn=Nn(),zn=pt(qn);function Un(a,l){let f="bright",u;return/water|ocean|lake|sea|river/.test(a)&&(u="blue"),/state|country|place/.test(a)&&(u="pink"),/road|highway|transport|streets/.test(a)&&(u="orange"),/contour|building|earth/.test(a)&&(u="monochrome"),/building/.test(a)&&(f="dark"),/earth/.test(a)&&(f="light"),/contour|landuse/.test(a)&&(u="yellow"),/wood|forest|park|landcover|land|natural/.test(a)&&(u="green"),`rgba(${zn({luminosity:f,hue:u,seed:a,format:"rgbArray"}).join(", ")}, ${l||"1"})`}var Kn={brightColor:Un};function Jn(a){return a.metadata&&a.metadata["maplibregl-inspect:inspect"]}function Wn(a){return Object.assign(a,{metadata:Object.assign({},a.metadata,{"maplibregl-inspect:inspect":!0})})}class ft{constructor(l){if(this._onSourceChange=u=>{if(u.sourceDataType==="visibility"||!u.isSourceLoaded)return;const g=Object.assign({},this.sources);this._setSourcesFromMap(),!En(g,this.sources)&&Object.keys(this.sources).length>0&&setTimeout(()=>this.render(),1e3)},this._onStyleChange=()=>{const u=this._map.getStyle();Jn(u)||(this._originalStyle=u)},this._onRightClick=()=>{!this.options.showMapPopupOnHover&&!this.options.showInspectMapPopupOnHover&&!this.options.blockHoverPopupOnClick&&this._popup&&this._popup.remove()},this._onMousemove=u=>{if(this._showInspectMap){if(!this.options.showInspectMapPopup||u.type==="mousemove"&&!this.options.showInspectMapPopupOnHover)return;u.type==="click"&&this.options.showInspectMapPopupOnHover&&this.options.blockHoverPopupOnClick&&(this._popupBlocked=!this._popupBlocked)}else{if(!this.options.showMapPopup||u.type==="mousemove"&&!this.options.showMapPopupOnHover)return;u.type==="click"&&this.options.showMapPopupOnHover&&this.options.blockHoverPopupOnClick&&(this._popupBlocked=!this._popupBlocked)}if(!this._popupBlocked&&this._popup){let g;this.options.selectThreshold===0?g=u.point:g=[[u.point.x-this.options.selectThreshold,u.point.y+this.options.selectThreshold],[u.point.x+this.options.selectThreshold,u.point.y-this.options.selectThreshold]];const S=this._map.queryRenderedFeatures(g,this.options.queryParameters)||[];if(this._map.getCanvas().style.cursor=S.length?"pointer":"",!S.length)this._popup.remove();else{this._popup.setLngLat(u.lngLat);const _=this.options.renderPopup(S);typeof _=="string"?this._popup.setHTML(_):this._popup.setDOMContent(_),this._popup.addTo(this._map)}}},!(this instanceof ft))throw new Error("MaplibreInspect needs to be called with the new keyword");let f=null;window.maplibregl?f=new window.maplibregl.Popup({closeButton:!1,closeOnClick:!1}):l.popup||console.error("Maplibre GL JS can not be found. Make sure to include it or pass an initialized MaplibreGL Popup to MaplibreInspect if you are using moduleis."),this.options=Object.assign({showInspectMap:!1,showInspectButton:!0,showInspectMapPopup:!0,showMapPopup:!1,showMapPopupOnHover:!0,showInspectMapPopupOnHover:!0,blockHoverPopupOnClick:!1,backgroundColor:"#fff",assignLayerColor:Kn.brightColor,buildInspectStyle:lt.generateInspectStyle,renderPopup:Dn,popup:f,selectThreshold:5,useInspectStyle:!0,queryParameters:{},sources:{},toggleCallback(){},manageStyleOutside:!1},l),this.sources=this.options.sources,this.assignLayerColor=this.options.assignLayerColor,this._popup=this.options.popup,this._popupBlocked=!1,this._showInspectMap=this.options.showInspectMap,this._toggle=new kn({show:this.options.showInspectButton,onToggle:()=>this.toggleInspector()})}toggleInspector(){this._showInspectMap=!this._showInspectMap,this._popupBlocked=!1,this.options.toggleCallback(this._showInspectMap),this.render()}_inspectStyle(){const l=lt.generateColoredLayers(this.sources,this.assignLayerColor);return this.options.buildInspectStyle(this._map.getStyle(),l,{backgroundColor:this.options.backgroundColor})}render(){this._showInspectMap?(this.options.useInspectStyle&&this._map.setStyle(Wn(this._inspectStyle())),this._toggle.setMapIcon()):this._originalStyle&&(this._popup&&this._popup.remove(),this.options.useInspectStyle&&this._map.setStyle(this._originalStyle),this._toggle.setInspectIcon())}_setSourcesFromMap(){const l=Object.keys(this._map.getStyle().sources);Object.keys(this._map.style.sourceCaches).forEach(f=>{const u=this._map.style.sourceCaches[f]||{_source:{}},g=u._source.vectorLayerIds;g?this.sources[f]=g:u._source.type==="geojson"&&(this.sources[f]=[])}),Object.keys(this.sources).forEach(f=>{l.indexOf(f)===-1&&delete this.sources[f]})}setOriginalStyle(l){this._originalStyle=l,this._setSourcesFromMap()}onAdd(l){return this._map=l,Object.keys(this.sources).length===0&&(l.on("tiledata",this._onSourceChange),l.on("sourcedata",this._onSourceChange)),l.on("styledata",this._onStyleChange),l.on("load",this._onStyleChange),l.on("mousemove",this._onMousemove),l.on("click",this._onMousemove),l.on("contextmenu",this._onRightClick),this._toggle.elem}onRemove(){this._map.off("styledata",this._onStyleChange),this._map.off("load",this._onStyleChange),this._map.off("tiledata",this._onSourceChange),this._map.off("sourcedata",this._onSourceChange),this._map.off("mousemove",this._onMousemove),this._map.off("click",this._onMousemove),this._map.off("contextmenu",this._onRightClick);const l=this._toggle.elem;l.parentNode.removeChild(l),this._map=void 0}}export{ft as M};
